:root {
  --space-1: 8px;
  --space-2: 12px;
  --space-3: 16px;
  --space-4: 24px;
  --bg-top: #f7f7f8;
  --bg-bottom: #f7f7f8;
  --ink: #202124;
  --ink-muted: #6b7280;
  --card: #ffffff;
  --card-edge: #e5e7eb;
  --accent: #ff5d47;
  --accent-soft: #ff866f;
  --accent-shadow: rgb(255 93 71 / 0.32);
  --accent-glow: rgb(255 93 71 / 0.09);
  --track: #d8dce3;
  --shadow: 0 6px 18px rgb(15 23 42 / 0.06);
}

* { box-sizing: border-box; }
body {
  margin: 0;
  min-height: 100vh;
  color: var(--ink);
  background: linear-gradient(180deg, var(--bg-top), var(--bg-bottom));
}

.app-shell { display: grid; min-height: 100vh; place-items: center; padding: 1.5rem; }
.stats-shell { align-items: start; }
.timer-card {
  width: min(760px, 100%);
  border-radius: 32px;
  border: 1px solid var(--card-edge);
  background: var(--card);
  box-shadow: var(--shadow);
  padding: calc(var(--space-4) + var(--space-1));
}
.stats-card { width: min(980px, 100%); }
.auth-card { width: min(560px, 100%); }

.heading-block h1 { margin: 0.2rem 0 0.4rem; font-size: clamp(1.8rem, 4vw, 2.6rem); letter-spacing: -0.03em; }
.eyebrow { text-transform: uppercase; letter-spacing: 0.14em; margin: 0; color: var(--ink-muted); font-size: 0.78rem; }
.subtitle { margin: 0; color: var(--ink-muted); }
.header-row { display: flex; justify-content: space-between; gap: 1rem; align-items: center; }
.nav-group { display: flex; gap: 0.5rem; }
.nav-group-row {
  margin-top: .75rem;
  flex-wrap: wrap;
  justify-content: flex-start;
}
.header-mobile-actions { display: none; }
.mobile-menu-wrap { position: relative; }
.mobile-menu-toggle {
  min-width: 96px;
  border-radius: 12px;
  background: #fff;
  border: 1px solid #e1e5ec;
}
.mobile-nav-panel {
  position: absolute;
  right: 0;
  top: calc(100% + 6px);
  min-width: 180px;
  display: grid;
  gap: 2px;
  background: #fff;
  border: 1px solid #e4e8ef;
  border-radius: 10px;
  padding: 6px;
  box-shadow: 0 10px 20px rgb(15 23 42 / 0.1);
  z-index: 20;
}
.mobile-nav-panel::before {
  content: "";
  position: absolute;
  top: -6px;
  right: 14px;
  width: 10px;
  height: 10px;
  background: #fff;
  border-left: 1px solid #e4e8ef;
  border-top: 1px solid #e4e8ef;
  transform: rotate(45deg);
}
.mobile-nav-item {
  display: flex;
  align-items: center;
  width: 100%;
  min-height: 38px;
  border-radius: 8px;
  border: 0;
  background: transparent;
  color: #243447;
  font-size: .84rem;
  font-weight: 700;
  text-decoration: none;
  padding: .42rem .55rem;
}
.mobile-nav-item:hover {
  background: #f3f4f6;
}
.mobile-nav-item:active {
  background: #eceff3;
}
.nav-link { text-decoration: none; display: inline-flex; align-items: center; }
.quick-header-btn { min-width: 150px; }

.project-panel, .filters-row { margin-top: var(--space-3); display: flex; flex-wrap: wrap; gap: var(--space-2); }
.project-panel-bottom { margin-top: var(--space-2); }
.period-nav-row { align-items: center; }
.stats-controls-mobile { display: none; }
.inline-field { display: grid; gap: 0.3rem; color: var(--ink-muted); font-size: 0.88rem; min-width: 180px; }
.inline-grow { flex: 1; }
.inline-row { display: flex; gap: 0.5rem; }
.badge-picker { display: flex; gap: .5rem; flex-wrap: wrap; max-height: 132px; overflow: auto; padding-right: .2rem; }
.project-badge {
  display: inline-flex;
  align-items: center;
  gap: .45rem;
  border: 1px solid #d8dee8;
  background: #fff;
  color: #374151;
  border-radius: 999px;
  padding: .48rem .78rem;
  min-height: 40px;
  font-size: .82rem;
  font-weight: 700;
  cursor: pointer;
}
.project-badge.is-active {
  background: color-mix(in srgb, var(--accent) 12%, #ffffff);
  border-color: color-mix(in srgb, var(--accent) 44%, #cfd6e0);
  color: #111827;
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--accent) 35%, #e5e7eb);
}
.project-badge-dot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  border: 1px solid rgb(15 23 42 / 0.14);
  flex: 0 0 auto;
}

.mode-switch { margin-top: 1.2rem; padding: 0.35rem; border-radius: 999px; background: rgba(20,34,53,.08); display: flex; gap: .35rem; }
.mode-btn { flex: 1; border: 0; border-radius: 999px; padding: .85rem .9rem; min-height: 48px; font: inherit; font-weight: 600; background: transparent; color: var(--ink-muted); cursor: pointer; }
.mode-btn.is-active { background: #fff; color: var(--ink); box-shadow: 0 6px 18px rgba(20,34,53,.12); }

.session-stage {
  margin-top: 1.2rem;
  border-radius: 22px;
  padding: .8rem;
  background: #fff;
  border: 1px solid #e5e7eb;
  box-shadow: none;
}
.session-stage.is-running {
  animation: session-pulse 1.6s ease-in-out infinite;
}

.clock-wrap { margin: 1.6rem auto 0; width: min(360px,100%); position: relative; display: grid; place-items: center; }
.progress-ring { width: min(320px,100%); transform: rotate(-90deg); }
.progress-ring__track, .progress-ring__bar { fill: transparent; stroke-width: 14; }
.progress-ring__track { stroke: var(--track); }
.progress-ring__bar { stroke-linecap: round; transition: stroke-dashoffset 280ms linear, stroke 220ms ease; }
.clock-text { position: absolute; text-align: center; }
.clock-text p { margin: 0; }
.time-display { font-size: clamp(3rem,9vw,4.8rem); font-weight: 700; letter-spacing: -0.05em; line-height: 1; margin: .2rem 0 .3rem; }

.control-row { margin-top: var(--space-3); display: flex; gap: .7rem; justify-content: center; }
.control-row-mobile { display: none; }
button { font: inherit; }
.primary, .ghost { border-radius: 12px; padding: .9rem 1.3rem; min-height: 48px; border: 0; font-weight: 700; cursor: pointer; }
.primary { background: linear-gradient(120deg, var(--accent), var(--accent-soft)); color: #fff; box-shadow: 0 10px 20px var(--accent-shadow); }
.ghost { background: #fff; color: var(--ink); border: 1px solid #d8e2ef; }

.live-stats {
  margin-top: var(--space-3);
  display: grid;
  gap: var(--space-2);
  grid-template-columns: minmax(180px, 240px) minmax(0, 1fr);
  align-items: start;
}
.stat-chip {
  border: 1px solid #d2deee;
  border-radius: 14px;
  background: #fff;
  padding: var(--space-2) var(--space-3);
  height: auto;
}
.stat-chip--today {
  padding: var(--space-2);
}
.chip-label { margin: 0; color: var(--ink-muted); font-size: .82rem; }
.chip-value { margin: .28rem 0 0; font-size: 1.18rem; font-weight: 700; }
.chip-subvalue { margin: .25rem 0 0; color: var(--ink-muted); font-size: .78rem; }
.rank-chip-btn { text-align: left; }
.rank-chip-btn { grid-column: 1 / -1; }
.chip-action-link {
  margin-top: .55rem;
  display: inline-flex;
  text-decoration: none;
}
.state-pill {
  margin-top: .5rem;
  display: inline-flex;
  align-items: center;
  border-radius: 999px;
  border: 1px solid #c5d5e8;
  padding: .36rem .72rem;
  font-weight: 700;
  font-size: .78rem;
}
.signal-pill { margin-bottom: .5rem; }
.signal-pill--primary {
  font-size: .92rem;
  font-weight: 800;
  min-height: 42px;
  padding: .52rem .95rem;
  border-width: 2px;
}
.bio-metrics-grid {
  margin-top: .45rem;
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: .42rem;
}
.bio-desktop { display: block; }
.bio-mobile { display: none; }
.bio-mobile-row {
  width: 100%;
  border: 0;
  background: transparent;
  padding: 0;
  text-align: left;
}
.bio-mobile-summary {
  display: block;
  color: var(--ink-muted);
  font-size: .78rem;
  margin-top: .2rem;
}
.bio-mobile-chevron {
  display: inline-flex;
  margin-top: .3rem;
  color: #5a708c;
  font-size: .74rem;
  font-weight: 700;
}
.bio-mobile-details { margin-top: .45rem; }
.bio-metric-pill {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 34px;
  border-radius: 10px;
  border: 1px solid #e3e8ef;
  background: #fafbfc;
  color: #455b74;
  font-size: .74rem;
  font-weight: 600;
  padding: .36rem .55rem;
  text-align: center;
}
.tone-restored { background: #e8f8ef; color: #145c2f; border-color: #b8e7c9; }
.tone-relaxed { background: #e8f1ff; color: #1d4f95; border-color: #bdd2f4; }
.tone-engaged { background: #fff6de; color: #7a4b00; border-color: #f0d39b; }
.tone-stressed { background: #ffe9e6; color: #8a1f14; border-color: #f1b4ad; }
.tone-neutral { background: #f2f5fa; color: #47607d; border-color: #d7e1ef; }

.settings-panel { margin-top: 1.5rem; border-top: 1px solid #d4dfec; padding-top: 1.2rem; }
.settings-panel h2 { margin: 0; font-size: 1rem; }
.settings-grid, .manual-log-grid { margin-top: .8rem; display: grid; grid-template-columns: repeat(2,minmax(0,1fr)); gap: .8rem; }
.manual-submit-wrap { align-self: end; }
.step-grid { margin-top: .85rem; display: grid; gap: .8rem; grid-template-columns: repeat(2,minmax(0,1fr)); }
.step-card { border: 1px solid #d2deee; border-radius: 14px; background: rgba(255,255,255,.88); padding: .8rem; }
.step-card p { margin: 0; color: var(--ink-muted); font-size: .86rem; }
.step-row { margin-top: .5rem; display: flex; align-items: center; justify-content: space-between; gap: .6rem; }
.step-row strong { font-size: 1.3rem; min-width: 52px; text-align: center; }
.step-btn { min-width: 46px; min-height: 46px; border-radius: 12px; padding: 0; font-size: 1.2rem; }
.step-card input[type=\"range\"] { margin-top: .55rem; width: 100%; accent-color: #2b5d8b; }
.quick-actions { margin-top: 1rem; display: grid; gap: .45rem; }
.quick-log-btn { width: 100%; }
.quick-settings-link { justify-content: center; }
.top-message { margin-top: .85rem; }
.project-create-panel .inline-row .primary { min-width: 140px; }
.preset-row { display: flex; gap: .5rem; margin-top: .8rem; flex-wrap: wrap; }
.preset-btn { min-width: 98px; }
.date-toggle-row { display: flex; gap: .45rem; flex-wrap: wrap; }
.date-toggle-btn {
  border: 1px solid #c5d5e8;
  border-radius: 999px;
  background: #f5f9ff;
  color: var(--ink);
  font-size: .82rem;
  font-weight: 700;
  min-height: 38px;
  padding: .4rem .7rem;
}
.date-toggle-btn.is-active {
  background: #2b5d8b;
  border-color: #2b5d8b;
  color: #fff;
}

label { display: grid; gap: .35rem; font-size: .88rem; color: var(--ink-muted); }
input, select { width: 100%; padding: .6rem .7rem; border-radius: 10px; border: 1px solid #c5d5e8; font: inherit; color: var(--ink); background: #fbfdff; }
.hint { margin-bottom: 0; color: var(--ink-muted); font-size: .78rem; }
.error-text { color: #b3261e; }

.stats-metrics, .compare-grid { margin-top: 1.2rem; display: grid; gap: .8rem; }
.stats-metrics { grid-template-columns: repeat(4,minmax(0,1fr)); }
.compare-grid { grid-template-columns: repeat(2,minmax(0,1fr)); }
.summary-block { margin-top: 1.2rem; }
.summary-block > h2 {
  margin: 0;
  font-size: 1rem;
  color: var(--ink-muted);
  font-weight: 700;
}
.stats-metrics-summary { margin-top: .65rem; }
.metric-card--full { grid-column: 1 / -1; }
.metric-card { border-radius: 16px; background: rgba(255,255,255,.88); border: 1px solid #d2deee; padding: 1rem; }
.metric-card p { margin: 0; color: var(--ink-muted); }
.metric-card h2 { margin: .35rem 0 0; font-size: 1.7rem; word-break: break-word; }
.metric-note { margin-top: .3rem; display: inline-block; color: var(--ink-muted); font-size: .85rem; }
.oura-card {
  background: linear-gradient(140deg, rgba(255,255,255,.98), rgba(237,246,255,.9));
}
.oura-stats-grid {
  margin-top: .8rem;
  display: grid;
  gap: .8rem;
  grid-template-columns: repeat(2,minmax(0,1fr));
}
.stress-context {
  margin-top: .6rem;
  padding-top: .5rem;
  border-top: 1px dashed #d5e2f2;
}
.stress-chip-row {
  margin-top: .42rem;
  display: flex;
  flex-wrap: wrap;
  gap: .42rem;
}
.stress-chip {
  display: inline-flex;
  align-items: center;
  min-height: 28px;
  border-radius: 999px;
  border: 1px solid #d8e1ec;
  background: #f8fafc;
  color: #60758f;
  font-size: .72rem;
  font-weight: 600;
  padding: .24rem .58rem;
}
.rank-card { background: linear-gradient(140deg,#132a44,#16375a); border-color: #1f476e; }
.rank-card p, .rank-card h2, .rank-card span { color: #f4f9ff; }
.rank-card span { font-size: .86rem; }
.rank-card--muted {
  position: relative;
  background: #fff;
  border-color: #dbe2eb;
  box-shadow: none;
}
.rank-card--muted::before {
  content: "";
  position: absolute;
  left: 0;
  top: 10px;
  bottom: 10px;
  width: 3px;
  border-radius: 999px;
  background: #5e86b1;
}
.rank-card--muted p {
  color: #5f6f82;
}
.rank-card--muted h2 {
  color: #2f5f93;
}
.rank-card--muted span {
  color: #8a96a6;
}
.rank-card-action {
  text-decoration: none;
  display: block;
  width: 100%;
  text-align: left;
  cursor: pointer;
}

.chart-panel, .rank-panel { margin-top: 1.2rem; border-radius: 18px; background: rgba(255,255,255,.82); border: 1px solid #d2deee; padding: 1rem; }
.chart-head { display: flex; justify-content: space-between; align-items: baseline; gap: 1rem; }
.chart-head h2, .rank-panel h2 { margin: 0; font-size: 1.1rem; }
.chart-head p { margin: 0; color: var(--ink-muted); font-size: .86rem; }

.line-chart-wrap { margin-top: 1rem; position: relative; border: 1px solid #d6e4f5; border-radius: 14px; background: #f7fbff; padding: .6rem .6rem 2rem 1.8rem; }
.line-chart { width: 100%; height: 240px; overflow: visible; }
.axis-line { stroke: #9db3cf; stroke-width: 1.5; }
.guide-line { stroke: #c8d9ed; stroke-width: 1; stroke-dasharray: 4 4; }
.trend-area { fill: rgba(255, 93, 71, 0.15); }
.trend-line { fill: none; stroke: var(--accent); stroke-width: 3; stroke-linecap: round; stroke-linejoin: round; }
.trend-dot { fill: #fff; stroke: var(--accent); stroke-width: 2; }
.y-guides { position: absolute; left: .5rem; top: .65rem; bottom: 2.25rem; display: flex; flex-direction: column; justify-content: space-between; color: var(--ink-muted); font-size: .75rem; }
.x-labels { position: absolute; left: 1.8rem; right: .8rem; bottom: .5rem; height: 1rem; }
.x-labels span { position: absolute; transform: translateX(-50%); color: var(--ink-muted); font-size: .74rem; white-space: nowrap; }

.rank-ladder { margin-top: .9rem; display: grid; grid-template-columns: repeat(3,minmax(0,1fr)); gap: .65rem; }
.rank-tier { border: 1px solid #d2deee; border-radius: 12px; padding: .7rem; background: rgba(255,255,255,.85); }
.rank-tier h3, .rank-tier p { margin: 0; }
.rank-tier p { margin-top: .25rem; color: var(--ink-muted); font-size: .82rem; }
.rank-tier.is-active { border-color: #1f476e; background: linear-gradient(140deg,#1f476e,#2b5d8b); }
.rank-tier.is-active h3, .rank-tier.is-active p { color: #f4f9ff; }
.rank-tier--muted-active {
  border-color: #dbe2eb !important;
  background: #fff !important;
  box-shadow: inset 3px 0 0 #5e86b1;
}
.rank-tier--muted-active h3 { color: #2f5f93 !important; }
.rank-tier--muted-active p { color: #7a8696 !important; }
.project-rows { margin-top: .8rem; display: grid; gap: .8rem; }
.project-row { border: 1px solid #d2deee; border-radius: 12px; padding: .7rem; background: rgba(255,255,255,.78); }
.project-row-meta { display: flex; justify-content: space-between; gap: .6rem; align-items: center; }
.project-row-meta span { color: var(--ink-muted); font-size: .88rem; }
.project-row-bar-track { margin-top: .45rem; width: 100%; height: 8px; border-radius: 999px; background: #dbe7f6; overflow: hidden; }
.project-row-bar-fill { height: 100%; border-radius: 999px; background: linear-gradient(120deg, var(--accent), var(--accent-soft)); }
.project-row--manage { display: grid; gap: .55rem; }
.project-actions { display: flex; justify-content: flex-end; }
.mobile-accordion-toggle { display: none; }
.mobile-accordion-body { display: block; }
.project-title-with-color {
  display: inline-flex;
  align-items: center;
  gap: .45rem;
}
.project-color-dot {
  width: 12px;
  height: 12px;
  border-radius: 999px;
  border: 1px solid #d6e2ef;
}
.project-color-control {
  display: grid;
  gap: .35rem;
  color: var(--ink-muted);
  font-size: .82rem;
}
.project-color-row {
  display: flex;
  align-items: center;
  gap: .5rem;
  flex-wrap: wrap;
}
.project-hex-input {
  width: 120px;
  min-height: 36px;
  border: 1px solid #cad8ea;
  border-radius: 10px;
  padding: .45rem .55rem;
  font: inherit;
  color: var(--ink);
  background: #fff;
}
.project-color-save {
  min-height: 36px;
  padding: .5rem .75rem;
}
.project-color-control--create .project-hex-input {
  width: 110px;
}
.project-color-control input[type="color"],
.color-field input[type="color"] {
  width: 48px;
  height: 36px;
  border-radius: 10px;
  border: 1px solid #cad8ea;
  padding: 0;
  background: #fff;
  cursor: pointer;
}
.color-field {
  min-width: 78px;
}

.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(17, 31, 48, 0.45);
  display: grid;
  place-items: center;
  padding: 1rem;
  z-index: 50;
}
.modal-card {
  width: min(560px, 100%);
  border-radius: 20px;
  border: 1px solid #d2deee;
  background: rgba(255, 255, 255, 0.96);
  box-shadow: 0 20px 40px rgba(17, 31, 48, 0.24);
  padding: 1rem;
}
.modal-head { display: flex; justify-content: space-between; align-items: center; gap: .6rem; }
.modal-head h2 { margin: 0; font-size: 1.2rem; }
.modal-actions { justify-content: flex-end; margin-top: .8rem; }
.modal-project-picker { margin-top: .6rem; max-height: 180px; }
.rank-change-card.is-up {
  background: linear-gradient(145deg, rgba(235,255,245,.98), rgba(247,255,251,.95));
  border-color: #bde9cd;
}
.rank-change-card.is-down {
  background: linear-gradient(145deg, rgba(255,245,242,.98), rgba(255,251,250,.95));
  border-color: #f1c8bf;
}
.rank-change-copy {
  margin: .6rem 0 0;
  color: var(--ink);
  line-height: 1.45;
}
.recovery-card {
  background: linear-gradient(145deg, rgba(232,241,255,.98), rgba(250,253,255,.95));
  border-color: #c3d7f3;
}
.side-panel {
  width: min(480px, 100%);
  height: min(100vh, 820px);
  border-radius: 20px;
  border: 1px solid #d2deee;
  background: rgba(255, 255, 255, 0.97);
  box-shadow: 0 20px 40px rgba(17, 31, 48, 0.24);
  padding: 1rem;
  overflow: auto;
}
.rank-ladder--single { grid-template-columns: 1fr; }

@keyframes session-pulse {
  0% { box-shadow: 0 0 0 rgb(0 0 0 / 0); }
  50% { box-shadow: 0 0 0 8px var(--accent-glow); }
  100% { box-shadow: 0 0 0 rgb(0 0 0 / 0); }
}
.project-scroll-picker {
  flex-wrap: nowrap;
  overflow-x: auto;
  max-height: none;
  padding-bottom: .25rem;
  gap: .45rem;
}
.project-scroll-picker h3 {
  margin: .15rem .3rem 0 0;
  white-space: nowrap;
  font-size: .82rem;
  color: var(--ink-muted);
}
.project-scroll-picker .project-badge {
  white-space: nowrap;
}
.project-picker-mobile { display: none; }
.project-mobile-trigger {
  width: 100%;
  border: 1px solid #dde3eb;
  background: #fff;
  color: #374151;
  border-radius: 14px;
  min-height: 62px;
  padding: .55rem .75rem;
  display: grid;
  gap: .42rem;
  text-align: left;
}
.project-mobile-label {
  font-size: .7rem;
  text-transform: uppercase;
  letter-spacing: .08em;
  color: #6b7280;
  opacity: .8;
}
.project-mobile-main {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: .45rem;
  border-radius: 10px;
  background: #f9fafb;
  border: 1px solid #e3e8ef;
  padding: .45rem .5rem;
}
.project-mobile-main-left {
  min-width: 0;
  display: inline-flex;
  align-items: center;
  gap: .45rem;
}
.project-mobile-value {
  font-size: .92rem;
  font-weight: 700;
  color: #1f2937;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.project-mobile-chevron {
  font-size: .72rem;
  font-weight: 700;
  color: #4b5563;
  border: 1px solid #d9e1ea;
  border-radius: 999px;
  padding: .2rem .45rem;
  background: #fff;
}
.mobile-sheet {
  width: min(520px, 100%);
  max-height: min(72vh, 640px);
  border-radius: 18px;
  border: 1px solid #d2deee;
  background: rgba(255, 255, 255, 0.98);
  box-shadow: 0 20px 40px rgba(17, 31, 48, 0.24);
  padding: .9rem;
  overflow: auto;
}
.mobile-project-list {
  margin-top: .65rem;
  display: grid;
  gap: .48rem;
}
.mobile-project-list .project-badge {
  width: 100%;
  text-align: left;
}

@media (max-width: 980px) {
  .stats-metrics { grid-template-columns: repeat(2,minmax(0,1fr)); }
  .rank-ladder { grid-template-columns: repeat(2,minmax(0,1fr)); }
}
@media (max-width: 640px) {
  .timer-card { padding: var(--space-3); border-radius: 24px; }
  .settings-grid, .manual-log-grid, .stats-metrics, .rank-ladder, .live-stats, .compare-grid, .oura-stats-grid { grid-template-columns: 1fr; }
  .bio-metrics-grid { grid-template-columns: 1fr; }
  .step-grid { grid-template-columns: 1fr; }
  .control-row, .inline-row { flex-wrap: wrap; width: 100%; }
  .control-row-desktop { display: none; }
  .control-row-mobile { margin-top: var(--space-2); display: grid; gap: .45rem; }
  .mobile-tools-toggle { width: 100%; }
  .mobile-tools-panel { display: grid; gap: .45rem; }
  .mobile-tools-panel .ghost { width: 100%; }
  .primary, .ghost { flex: 1; }
  .header-row, .chart-head, .project-panel, .filters-row { flex-direction: column; align-items: flex-start; }
  .nav-group-row { display: none; }
  .header-mobile-actions {
    width: 100%;
    margin-top: .75rem;
    display: flex;
    gap: .5rem;
    align-items: center;
  }
  .quick-header-btn-mobile { flex: 1; }
  .control-row > .primary,
  .control-row > .ghost { min-width: 100%; }
  .mode-switch { display: none; }
  .period-nav-row > .ghost { width: 100%; }
  .project-row-meta { flex-direction: column; align-items: flex-start; }
  .project-actions { width: 100%; }
  .project-actions .ghost { width: 100%; }
  .project-color-row { width: 100%; }
  .project-color-save { width: 100%; }
  .badge-picker { max-height: 168px; }
  .project-badge { width: 100%; text-align: left; }
  .project-scroll-picker { max-height: none; }
  .project-scroll-picker .project-badge { width: auto; text-align: center; }
  .project-scroll-picker { display: none; }
  .project-picker-mobile { display: block; width: 100%; }
  .bio-desktop { display: none; }
  .bio-mobile { display: block; }
  .live-stats {
    margin-top: var(--space-2);
    grid-template-columns: 1fr;
    gap: var(--space-2);
  }
  .rank-chip-btn { grid-column: auto; }
  .stat-chip {
    border-color: #e3ebf6;
    background: #fff;
    padding: .72rem .78rem;
  }
  .stat-chip--today { padding: .66rem .74rem; }
  .chip-value { font-size: 1.06rem; }
  .date-toggle-row { width: 100%; }
  .date-toggle-btn { flex: 1; min-width: 92px; }
  .x-labels span { font-size: .68rem; }
  .modal-card, .side-panel { padding: .9rem; width: 100%; border-radius: 16px; }
  .side-panel { height: auto; max-height: 86vh; }

  .stats-controls-desktop { display: none; }
  .stats-controls-mobile {
    position: sticky;
    top: .4rem;
    z-index: 15;
    display: grid;
    gap: .5rem;
    margin-top: .8rem;
    padding: .6rem;
    border: 1px solid #e5e7eb;
    border-radius: 14px;
    background: #fff;
  }
  .stats-mobile-pickers,
  .stats-mobile-nav {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: .45rem;
  }
  .stats-mobile-nav { grid-template-columns: repeat(3, minmax(0, 1fr)); }
  .stats-picker-btn {
    min-height: 44px;
    text-align: left;
    padding: .45rem .6rem;
  }
  .stats-picker-label {
    display: block;
    font-size: .66rem;
    text-transform: uppercase;
    letter-spacing: .08em;
    color: #6b7280;
  }
  .stats-picker-value {
    display: block;
    margin-top: .18rem;
    font-size: .84rem;
    font-weight: 700;
    color: #1f2937;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .summary-block { margin-top: .9rem; }
  .summary-block > h2 { font-size: .92rem; }
  .stats-metrics { margin-top: .55rem; gap: .6rem; grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .metric-card { padding: .78rem .8rem; border: 1px solid #e6eaf0; background: #fff; }
  .metric-card h2 { font-size: 1.25rem; }
  .metric-card p { font-size: .76rem; }
  .metric-note { font-size: .78rem; }
  .rank-card { border-color: #1f476e; }

  .mobile-accordion {
    margin-top: .75rem;
    border: 1px solid #e5e7eb;
    border-radius: 14px;
    background: #fff;
    overflow: hidden;
  }
  .mobile-accordion-toggle {
    width: 100%;
    min-height: 46px;
    border: 0;
    background: transparent;
    padding: .65rem .78rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: .6rem;
    text-align: left;
  }
  .mobile-accordion-toggle h2 {
    margin: 0;
    font-size: .95rem;
  }
  .mobile-accordion-toggle span {
    font-size: .74rem;
    color: #6b7280;
    font-weight: 700;
  }
  .mobile-accordion-body {
    display: none;
    padding: 0 .78rem .78rem;
  }
  .mobile-accordion.is-open .mobile-accordion-body { display: block; }

  .mobile-accordion .compare-grid,
  .mobile-accordion .chart-panel,
  .mobile-accordion .rank-panel {
    margin-top: .2rem;
  }
  .mobile-accordion .chart-panel,
  .mobile-accordion .rank-panel {
    border: 0;
    border-radius: 0;
    padding: 0;
    background: transparent;
  }
  .mobile-accordion .chart-head { justify-content: flex-start; }
  .mobile-accordion .chart-head h2 { display: none; }
  .mobile-accordion .chart-head p { font-size: .73rem; }
  .mobile-accordion .line-chart-wrap {
    margin-top: .45rem;
    border: 1px solid #e8edf3;
    border-radius: 12px;
    background: #fcfdff;
    padding: .45rem .45rem 1.8rem 1.2rem;
  }
  .mobile-accordion .project-rows { margin-top: .35rem; gap: .55rem; }
  .mobile-accordion .project-row {
    border: 1px solid #e8edf3;
    border-radius: 10px;
    background: #fff;
    padding: .58rem;
  }
  .stats-picker-sheet .project-badge { justify-content: flex-start; }
}

@media (min-width: 1024px) {
  .stats-page-card .stats-controls-desktop:not(.period-nav-row) {
    margin-top: var(--space-2);
    padding: var(--space-2);
    border: 1px solid #e4e9f1;
    border-radius: 12px;
    background: #fff;
    gap: var(--space-2);
  }
  .stats-page-card .stats-controls-desktop:not(.period-nav-row) .inline-field {
    min-width: 220px;
  }
  .stats-page-card .period-nav-row.stats-controls-desktop {
    margin-top: var(--space-2);
    display: inline-flex;
    align-items: center;
    gap: 0;
    border: 1px solid #e4e9f1;
    border-radius: 10px;
    background: #fff;
    padding: 2px;
    width: auto;
  }
  .stats-page-card .period-nav-row.stats-controls-desktop > .ghost {
    border: 0;
    border-radius: 8px;
    background: transparent;
    min-height: 38px;
    padding: 0 12px;
    font-size: .84rem;
    color: #4a5d73;
  }
  .stats-page-card .period-nav-row.stats-controls-desktop > .ghost:hover {
    background: #f3f5f8;
    color: #2f3f53;
  }
  .stats-page-card .rank-card--muted::before {
    width: 2px;
  }
  .stats-page-card .rank-card--muted span {
    color: #95a1b1;
  }
  .stats-page-card .chart-panel {
    margin-top: var(--space-3);
    border-color: #e7ecf2;
    background: #fff;
    padding: var(--space-3);
  }
  .stats-page-card .line-chart-wrap {
    border-color: #e8edf3;
    background: #fff;
  }

  .projects-page-card .project-row {
    padding: .58rem .62rem;
    border-color: #e4e9f0;
    background: #fff;
  }
  .projects-page-card .project-row--manage {
    gap: .42rem;
  }
  .projects-page-card .project-color-row {
    gap: var(--space-1);
  }
  .projects-page-card .project-color-save {
    min-height: 34px;
    padding: .4rem .68rem;
    font-size: .82rem;
  }
  .projects-page-card .project-hex-input {
    min-height: 34px;
    padding: .38rem .48rem;
  }
  .projects-page-card .project-create-panel .inline-row {
    align-items: end;
    gap: var(--space-2);
  }
  .projects-page-card .project-create-panel .inline-row .primary {
    min-width: 118px;
    min-height: 42px;
    padding: .62rem .9rem;
    font-size: .86rem;
  }
}
